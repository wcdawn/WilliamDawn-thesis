\section{Neutron Diffusion Results}
\label{sec:diffusionResults}

\begin{frame}{Verification and Validation}
  \begin{itemize}
    \item Comparison against analytic solutions and benchmark problems.
    \item Strategy from \cite{oberkampf}.
    \item ``Code Verification''
      \begin{itemize}
        \item Compare computational results to exact analytic or manufactured
          results.
        \item Demonstrate the code is solving equations correctly as designed.
        \item Quantified numerical errors.
      \end{itemize}
    \item ``Solution Verification''
      \begin{itemize}
        \item Compare computational results to benchmark results for the
          intended application of the solver.
        \item Computational results from a different method or experimental
          data.
        \item Typically verified by others previously.
      \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Error Analysis}
  FEM with linear elements is second-order convergent in space
  \cite{textbookli}.
  \begin{equation} 
    \label{eq:error_bound}
    \|\ve\|_{\infty} \le c h^2 \| \grad^2 \phi(\vr) \|_{\infty}
  \end{equation}
  It is useful to define the following errors.
  \begin{align}
    \ve &= \phi(\vr) - \phi_{FEM} \\
    \label{eq:rms}
    \text{RMS}(\ve) &= \sqrt{\frac{1}{N} \sum_{i=1}^{N} e_i^2} \\
    \label{eq:infnorm}
    \|\ve\|_{\infty} &= \max_{i=1,2,\ldots,N} \lvert e_i \rvert
  \end{align}
\end{frame}

\begin{frame}{Analytic Solutions}
  \begin{table}
    %\caption{}
    %\label{}
    \begin{tabular}{lcccc}
      \toprule
      Case & Dimensions & Groups & Criticality & Materials \\
      \midrule
      % One-Dimension, One-Group, Fixed Source
      1 & 1 & 1 &   & 1 \\
      % One-Dimension, One-Group, Criticality
      2 & 1 & 1 & \true & 1 \\
      % Two-Dimension, One-Group, Criticality
      3 & 2 & 1 & \true & 1 \\
      % One-Dimension, Two-Group, Criticality
      4 & 1 & 2 & \true & 1 \\
      % One-Dimension, One-Group, Two Region, Criticality
      5 & 1 & 1 & \true & 2 \\
      % Three-Dimension, One-Group, Finite Cylinder
      6 & 3 & 1 & \true & 1 \\
      \bottomrule
    \end{tabular}
  \end{table}
\end{frame}

\begin{frame}{Two-Dimension, One-Group, Criticality}
  Tests true two-dimension capabilites.
  \begin{table}
    %\caption{Two-Dimension, One-Group, Criticality Convergence Study
    %  Results.}
    \label{tab:2d1g}
    \begin{center}
      \resizebox{\textwidth}{!}{
      \begin{tabular}{cccccccccc}
        \toprule
        Refine & $\keff$ & $\keff$ error \units{pcm} & $\keff$ ratio & RMS & 
          RMS ratio  & $\|e\|_{\infty}$ & $\|e\|_{\infty}$ ratio \\
        \midrule
        \csvreader[
          late after line=\\,
          late after last line=\\,]
          {../ch03_diffusionResults/data/2d1g.csv}{}
          {\csvcoli & \csvcolii & \csvcoliii & \csvcoliv & \csvcolv & 
          \csvcolvi & \csvcolxi & \csvcolxii}
        Ref. & 1.996060  \\
        \bottomrule
      \end{tabular}
    }
    \end{center}
  \end{table}
  \begin{equation}
    \label{eq:analytic_2d1g}
    \phi(x,y) = \phi_0 \sin\left(\frac{\pi}{L_x} x\right) \, 
      \sin\left(\frac{\pi}{L_y} y\right)
  \end{equation}
\end{frame}

\begin{frame}{Two-Dimension, One-Group, Criticality}
  \begin{figure}
    \centering
    \includegraphics[width=0.7\textwidth]{2d1g}
    \caption{Two-Dimension Criticality Flux Shape.}
    \label{fig:2d1g}
  \end{figure}
\end{frame}

\begin{frame}{Three-Dimension, One-Group, Finite Cylinder}
  Tests wedge elements.
  \begin{table}
    %\caption{Finite Cylinder Convergence Study Results.}
    \label{tab:finite_cyl}
    \begin{center}
      \resizebox{\textwidth}{!}{
      \begin{tabular}{cccccccccc}
        \toprule
        Refine & $\keff$ & $\keff$ error \units{pcm} & $\keff$ ratio & RMS & 
          RMS ratio  & $\|e\|_{\infty}$ & $\|e\|_{\infty}$ ratio \\
        \midrule
        \csvreader[
          late after line=\\,
          late after last line=\\,]
          {../ch03_diffusionResults/data/finite_cyl.csv}{}
          {\csvcoli & \csvcolii & \csvcoliii & \csvcoliv & \csvcolv & 
          \csvcolvi & \csvcolxi & \csvcolxii}
        Ref. & 0.996711 \\
        \bottomrule
      \end{tabular}
    }
    \end{center}
  \end{table}
  \begin{figure}
    \centering
    \subfloat{\includegraphics[width=0.35\textwidth]{cir0}}
    \vspace{0.2in}
    \subfloat{\includegraphics[width=0.35\textwidth]{cir2}}
    \caption{Mesh Refinement of Curved Mesh.}
    \label{fig:circle_meshes}
  \end{figure}
  \begin{equation}
    \label{eq:analytic_finite_cyl}
    \phi(r,z) = \phi_0 \, 
      J_0\left(\frac{\alpha_0}{T} r\right) \sin\left(\frac{\pi}{H} z \right)
  \end{equation}
\end{frame}

\begin{frame}{Three-Dimension, One-Group, Finite Cylinder}
  \begin{figure}
    \centering
    \subfloat{\includegraphics[width=0.4\textwidth]{finite_cyl}}
    \hspace{0.2in}
    \subfloat{\includegraphics[width=0.4\textwidth]{./figs/finite_cyl_refine3}}
    \caption{Example Finite Cylinder Flux Shape.}
    \label{fig:finite_cyl}
  \end{figure}
\end{frame}

\begin{frame}{Benchmark Solutions}
  \begin{table}
    %\caption{}
    %\label{}
    \begin{center}
      \resizebox{\textwidth}{!}{
      \begin{tabular}{lccccc}
        \toprule
        Benchmark & Dimensions & Groups & Reactor Type &
          \parbox[t]{0.6in}{\centering Neutron \\ Spectrum} \\
        \midrule
        VVER440 & 2 & 2 & LWR & Thermal \\
        SNR     & 2 & 4 & SFR & Fast \\
        HWR     & 2 & 2 & HWR & Thermal \\
        IAEA ($\times4$)    & 2 & 2 & PWR & Thermal \\
        MONJU   & 3 & 3 & SFR & Fast \\
        KNK     & 3 & 4 & SFR & Fast \\
        \bottomrule
      \end{tabular}
    }
    \end{center}
  \end{table}
\end{frame}

\begin{frame}{VVER440}
  \begin{itemize}
    \item Two-dimensional.
    \item Light Water Reactor (LWR).
    \item Two-group.
  \end{itemize}
  \begin{table}
    \begin{center}
      %\caption{VVER440 Benchmark Convergence Study.}
      \label{tab:vver440}
      \begin{threeparttable}
        \begin{tabular}{cccc}
          \toprule
          Refine & $\keff$ & $\keff$ error \units{pcm} & $\keff$ ratio \\
          \midrule
          \csvreader[
            late after line=\\,
            late after last line=\\,]
            {../ch03_diffusionResults/data/vver440.csv}{}
            {\csvcoli & \csvcolvi & \csvcolvii & \csvcolviii}
          Ref.\tnote{$\dagger$}  & 1.009700 \\
          \bottomrule
        \end{tabular}
        \begin{tablenotes}
          \item[$\dagger$] See \cite{chao}.
        \end{tablenotes}
      \end{threeparttable}
    \end{center}
  \end{table}
\end{frame}

\begin{frame}{VVER440 Benchmark Power Comparison}
  \begin{figure}
    \centering
    \includegraphics[width=\textwidth]{./figs/diffusion_vver440_colored}
    %\caption{VVER440 Benchmark Power Comparison for Most Refined Mesh.}
    \label{fig:diffusion_vver440}
  \end{figure}
  \Put(25,350){\includegraphics[width=0.15\textwidth]{hex_description}}
\end{frame}

\begin{frame}{SNR}
  \begin{itemize}
    \item Two-dimensional.
    \item Sodium-cooled Fast Reactor (SFR).
    \item Four-group.
  \end{itemize}
  \begin{table}
    \begin{center}
      %\caption{SNR Benchmark Convergence Study.}
      \label{tab:snr}
      \begin{threeparttable}
        \begin{tabular}{cccc}
          \toprule
          Refine & $\keff$ & $\keff$ error \units{pcm} & $\keff$ ratio \\
          \midrule
          \csvreader[
            late after line=\\,
            late after last line=\\,]
            {../ch03_diffusionResults/data/snr.csv}{}
            {\csvcoli & \csvcolvi & \csvcolvii & \csvcolviii}
          Ref. \tnote{$\dagger$} & 1.124000 \\
          \bottomrule
        \end{tabular}
        \begin{tablenotes}
          \item[$\dagger$] See \cite{argonneBenchmark}.
        \end{tablenotes}
      \end{threeparttable}
    \end{center}
  \end{table}
\end{frame}

\begin{frame}{SNR Benchmark Power Comparison}
  \begin{figure}
    \centering
    \includegraphics[width=\textwidth]{diffusion_snr}
    %\caption{SNR Benchmark Power Comparison for Most Refined Mesh.}
    \label{fig:diffusion_snr}
  \end{figure}
  \Put(25,450){\includegraphics[width=0.15\textwidth]{hex_description}}
\end{frame}

\begin{frame}{HWR}
  \begin{itemize}
    \item Two-dimensional.
    \item Heavy Water Reactor (HWR).
    \item Two-group.
  \end{itemize}
  \begin{table}
    \begin{center}
      %\caption{HWR Benchmark Convergence Study.}
      \label{tab:hwr}
      \begin{threeparttable}
        \begin{tabular}{cccc}
          \toprule
          Refine & $\keff$ & $\keff$ error \units{pcm} & $\keff$ ratio \\
          \midrule
          \csvreader[
            late after line=\\,
            late after last line=\\,]
            {../ch03_diffusionResults/data/hwr.csv}{}
            {\csvcoli & \csvcolvi & \csvcolvii & \csvcolviii}
          Ref.\tnote{$\dagger$} & 0.991965  \\
          \bottomrule
        \end{tabular}
        \begin{tablenotes}
          \item[$\dagger$] See \cite{chao}.
        \end{tablenotes}
      \end{threeparttable}
    \end{center}
  \end{table}
\end{frame}

\begin{frame}{HWR Benchmark Power Comparison}
  \begin{figure}
    \centering
    \includegraphics[width=\textwidth]{diffusion_hwr}
    \caption{HWR Benchmark Power Comparison for Most Refined Mesh.}
    \label{fig:diffusion_hwr}
  \end{figure}
  \Put(25,450){\includegraphics[width=0.15\textwidth]{hex_description}}
\end{frame}

\begin{frame}{IAEA -- No Reflector $\albedo=0.125$}
  \begin{itemize}
    \item Two-dimensional.
    \item Pressurized Water Reactor (PWR).
    \item Two-group.
    \item Originally cartesian but converted to hexagonal in \cite{chao}.
  \end{itemize}
  % nore0125
  \begin{table}
    \begin{center}
      %\caption{IAEA Benchmark Convergence Study. No Reflector. $\albedo = 
      %  0.125$.}
      \label{tab:iaea_nore0125}
      \begin{threeparttable}
        \begin{tabular}{cccc}
          \toprule
          Refine & $\keff$ & $\keff$ error \units{pcm} & $\keff$ ratio \\
          \midrule
          \csvreader[
            late after line=\\,
            late after last line=\\,]
            {../ch03_diffusionResults/data/iaea_nore0125.csv}{}
            {\csvcoli & \csvcolvi & \csvcolvii & \csvcolviii}
          Ref. \tnote{$\dagger$} & 0.991378 \\
          \bottomrule
        \end{tabular}
        \begin{tablenotes}
          \item[$\dagger$] See \cite{chao}.
        \end{tablenotes}
      \end{threeparttable}
    \end{center}
  \end{table}
\end{frame}

\begin{frame}{IAEA -- No Reflector $\albedo=0.500$}
  \begin{itemize}
    \item Two-dimensional.
    \item Pressurized Water Reactor (PWR).
    \item Two-group.
    \item Originally cartesian but converted to hexagonal in \cite{chao}.
  \end{itemize}
  % nore0500
  \begin{table}
    \begin{center}
      %\caption{IAEA Benchmark Convergence Study. No Reflector. $\albedo = 
      %  0.500$.}
      \label{tab:iaea_nore0500}
      \begin{threeparttable}
        \begin{tabular}{cccc}
          \toprule
          Refine & $\keff$ & $\keff$ error \units{pcm} & $\keff$ ratio \\
          \midrule
          \csvreader[
            late after line=\\,
            late after last line=\\,]
            {../ch03_diffusionResults/data/iaea_nore0500.csv}{}
            {\csvcoli & \csvcolvi & \csvcolvii & \csvcolviii}
          Ref. \tnote{$\dagger$} & 0.978077 \\
          \bottomrule
        \end{tabular}
        \begin{tablenotes}
          \item[$\dagger$] See \cite{chao}.
        \end{tablenotes}
      \end{threeparttable}
    \end{center}
  \end{table}
\end{frame}

\begin{frame}{IAEA -- Reflector $\albedo=0.125$}
  \begin{itemize}
    \item Two-dimensional.
    \item Pressurized Water Reactor (PWR).
    \item Two-group.
    \item Originally cartesian but converted to hexagonal in \cite{chao}.
  \end{itemize}
  % refl0125
  \begin{table}
    \begin{center}
      %\caption{IAEA Benchmark Convergence Study. With Reflector. $\albedo = 
      %  0.125$.}
      \label{tab:iaea_refl0125}
      \begin{threeparttable}
        \begin{tabular}{cccc}
          \toprule
          Refine & $\keff$ & $\keff$ error \units{pcm} & $\keff$ ratio \\
          \midrule
          \csvreader[
            late after line=\\,
            late after last line=\\,]
            {../ch03_diffusionResults/data/iaea_refl0125.csv}{}
            {\csvcoli & \csvcolvi & \csvcolvii & \csvcolviii}
          Ref. \tnote{$\dagger$} & 1.006630 \\
          \bottomrule
        \end{tabular}
        \begin{tablenotes}
          \item[$\dagger$] See \cite{chao}.
        \end{tablenotes}
      \end{threeparttable}
    \end{center}
  \end{table}
\end{frame}

\begin{frame}{IAEA -- Reflector $\albedo=0.500$}
  \begin{itemize}
    \item Two-dimensional.
    \item Pressurized Water Reactor (PWR).
    \item Two-group.
    \item Originally cartesian but converted to hexagonal in \cite{chao}.
  \end{itemize}
  % refl0500
  \begin{table}
    \begin{center}
    %\caption{IAEA Benchmark Convergence Study. With Reflector. $\albedo = 
    %  0.500$.}
    \label{tab:iaea_refl0500}
      \begin{threeparttable}
        \begin{tabular}{cccc}
          \toprule
          Refine & $\keff$ & $\keff$ error \units{pcm} & $\keff$ ratio \\
          \midrule
          \csvreader[
            late after line=\\,
            late after last line=\\,]
            {../ch03_diffusionResults/data/iaea_refl0500.csv}{}
            {\csvcoli & \csvcolvi & \csvcolvii & \csvcolviii}
          Ref. \tnote{$\dagger$} & 1.005507 \\
          \bottomrule
        \end{tabular}
        \begin{tablenotes}
          \item[$\dagger$] See \cite{chao}.
        \end{tablenotes}
      \end{threeparttable}
    \end{center}
  \end{table}
\end{frame}

\begin{frame}{Three-Dimensional Problem Analysis}
  Typically more useful to compare control rod worth measurement.
  \begin{itemize}
    \item Case A. Control rods fully removed.
    \item Case B. Control rods partially inserted.
    \item Case C. Control rods fully inserted.
  \end{itemize}
  \begin{align}
    \label{eq:rodworth}
    \text{Rod Worth}_x \units{$\Delta k$} &= \frac{\keffsub{A} - \keffsub{x}}
      {\keffsub{A} \, \keffsub{x}} &\qquad x=\{B,C\} \\
    \label{eq:roddifference}
    \text{Rod Difference}_x \units{$\% \Delta k$} &= (\keffsub{A} - \keffsub{x}) 
      \times 100 \% &\qquad x=\{B,C\} \\
  \end{align}
\end{frame}

\begin{frame}{MONJU}
  \begin{itemize}
    \item Three-dimensional.
    \item Sodium-cooled Fast Reactor (SFR).
    \item Three-group.
    \item Fission spectrum, $\chi$ not provided and instead selected for
      benchmark agreement.
  \end{itemize}
  \begin{table}
    \begin{center}
      %\caption{MONJU Benchmark Rod Worth Results. \cite{monjuBenchmark}}
      \label{tab:monju}
      \begin{threeparttable}
        \begin{tabular}{ccll}
          \toprule
          Pattern & $\keff$ & Rod Worth \units{$\Delta k$} & 
            Rod Difference \units{\%$\Delta k$} \\
          \midrule
          A&1.056816&               &            \\
          B&1.031623&0.023 (2.51E-5) \tnote{$\dagger$} &2.52 (-0.07)\\
          C&1.006519&0.047 (1.77E-3)&5.03 (0.04) \\
          \bottomrule
        \end{tabular}
        \begin{tablenotes}
          \item[$\dagger$] Value in parentheses is difference to reference
            value from \cite{monjuBenchmark}.
        \end{tablenotes}
      \end{threeparttable}
    \end{center}
  \end{table}
\end{frame}

\begin{frame}{KNK}
  \begin{itemize}
    \item Three-dimensional.
    \item Sodium-cooled Fast Reactor (SFR).
    \item Four-group.
    \item Reference data is a transport problem.
  \end{itemize}
  \begin{table}
    \begin{center}
      %\caption{KNK Benchmark Rod Worth Results.}
      \label{tab:knk}
      \begin{threeparttable}
        \begin{tabular}{ccll}
          \toprule
          Pattern & $\keff$ & Rod Worth \units{$\Delta k$} & 
            Rod Difference \units{\%$\Delta k$} \\
          \midrule
          A&1.061752&               &            \\
          B&0.942404&0.119 (1.55E-2) \tnote{$\dagger$} &11.93 (0.75)\\
          C&0.829829&0.263 (3.99E-2)&23.19 (1.67)\\
          \bottomrule
        \end{tabular}
        \begin{tablenotes}
          \item[$\dagger$] Value in parentheses is difference to reference
            value from \cite{takedaBenchmark}.
        \end{tablenotes}
      \end{threeparttable}
    \end{center}
  \end{table}
\end{frame}
